<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Tech Stack ‚Äî Harsha Royal | UI Developer & Product Designer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5">
    <meta name="description" content="Explore Harsha Royal's specialized tech stack ‚Äî including Figma, React, Angular, Javascript, and SEO tools. A blend of design and development for modern web solutions.">
    <meta name="author" content="Harsha Royal">
    <link rel="shortcut icon" href="images/favicon.svg">
    <link rel="stylesheet" href="css/fonts.css">
    <link rel="stylesheet" href="css/inter.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/styles.css">
    <style>
        html { zoom: 1; }
        body {
            background: #ffffff;
            min-height: 100vh;
            overflow: hidden;
            position: relative;
            font-family: "Inter", sans-serif;
            margin: 0; padding: 0;
        }

        /* ===== FIGMA UI THEME ===== */
        .figma-app {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            background: #ffffff;
            position: fixed;
            inset: 0;
            z-index: 10;
            font-size: 11px;
            color: rgba(0,0,0,0.8);
            user-select: none;
        }
        .figma-toolbar {
            height: 48px;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 16px;
            background: #ffffff;
            flex-shrink: 0;
            z-index: 20;
        }
        .toolbar-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .toolbar-icon {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 6px;
            color: rgba(0,0,0,0.5);
            cursor: pointer;
            transition: all 0.2s;
        }
        .toolbar-icon.active, .toolbar-icon:hover {
            background: rgba(0,0,0,0.06);
            color: #333;
        }
        .toolbar-title {
            font-size: 12px;
            font-weight: 500;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
            letter-spacing: 0.02em;
        }
        .toolbar-title span { color: rgba(0,0,0,0.4); }
        .toolbar-title .filename { display: flex; align-items: center; gap: 4px; }
        .toolbar-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: #FF7518;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 0.05em;
        }
        .figma-workspace {
            display: flex;
            flex: 1;
            height: calc(100vh - 48px);
            overflow: hidden;
        }
        .figma-sidebar {
            width: 240px;
            background: #ffffff;
            display: flex;
            flex-direction: column;
            flex-shrink: 0;
            z-index: 20;
        }
        .figma-sidebar-left { border-right: 1px solid rgba(0,0,0,0.1); }
        .figma-sidebar-right { border-left: 1px solid rgba(0,0,0,0.1); }
        .sidebar-tabs {
            display: flex;
            border-bottom: 1px solid rgba(0,0,0,0.1);
            height: 40px;
            flex-shrink: 0;
        }
        .sidebar-tab {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            color: rgba(0,0,0,0.5);
            cursor: pointer;
            border-bottom: 2px solid transparent;
        }
        .sidebar-tab.active {
            color: #333;
            border-bottom-color: #FF7518;
        }
        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 8px 0;
        }
        .layer-item {
            display: flex;
            align-items: center;
            padding: 6px 16px 6px 20px;
            gap: 10px;
            cursor: pointer;
            opacity: 0.8;
            transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
            position: relative;
            color: rgba(0,0,0,0.8);
        }
        .layer-item:hover { background: rgba(0,0,0,0.04); }
        .layer-icon {
            opacity: 0.6;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            font-family: "Space Mono", monospace, sans-serif;
            color: rgba(0,0,0,0.6);
        }
        .layer-name {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 11px;
            letter-spacing: 0.02em;
        }
        .prop-section {
            border-bottom: 1px solid rgba(0,0,0,0.1);
            padding: 16px;
        }
        .prop-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-weight: 600;
            margin-bottom: 12px;
            color: rgba(0,0,0,0.85);
        }
        .prop-row {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 8px;
        }
        .prop-label {
            width: 24px;
            color: rgba(0,0,0,0.5);
            text-align: right;
            padding-right: 4px;
            font-size: 10px;
        }
        .prop-value {
            flex: 1;
            background: rgba(0,0,0,0.04);
            border: 1px solid transparent;
            border-radius: 4px;
            padding: 6px 8px;
            display: flex;
            align-items: center;
            justify-content: flex-start;
            font-family: inherit;
            color: #333;
            transition: border-color 0.2s;
            font-size: 11px;
        }
        .prop-value:hover { border-color: rgba(0,0,0,0.15); }
        .figma-canvas {
            flex: 1;
            position: relative;
            background: #e5e5e5;
            overflow: hidden;
            display: block;
            cursor: grab;
        }
        .figma-canvas:active {
            cursor: grabbing;
        }
        
        @media (max-width: 900px) { .figma-sidebar-right { display: none; } }
        @media (max-width: 600px) { .figma-sidebar-left { display: none; } .desktop-only { display: none !important; } }

        /* ===== CANVAS PANNING ===== */
        .pan-canvas {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            z-index: 5;
        }

        /* ===== DARK CANVAS ===== */
        .dark-canvas {
            position: absolute;
            inset: 0;
            background:
                radial-gradient(ellipse at 30% 20%, rgba(255,117,24,0.06) 0%, transparent 60%),
                radial-gradient(ellipse at 70% 80%, rgba(162,89,255,0.04) 0%, transparent 60%),
                #e5e5e5;
            z-index: 0;
        }

        .grid-overlay {
            position: absolute;
            inset: 0;
            background-image:
                linear-gradient(rgba(0,0,0,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.03) 1px, transparent 1px);
            background-size: 24px 24px;
            z-index: 0;
        }

        /* ===== MAIN STAGE ===== */
        .figma-layer {
            position: absolute;
            background: #ffffff;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1), 0 0 0 1px rgba(0,0,0,0.05);
            border-radius: 12px;
            z-index: 2;
            overflow: hidden;
        }

        .layer-title {
            position: absolute;
            top: -24px;
            left: 0;
            font-size: 11px;
            font-weight: 600;
            color: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
        }
        
        .hud-progress {
            position: absolute;
            bottom: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: #ffffff;
            border: 1px solid rgba(0,0,0,0.1);
            padding: 8px 16px;
            border-radius: 99px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            z-index: 100;
            font-size: 11px;
            font-weight: 500;
            color: rgba(0,0,0,0.6);
            display: flex;
            align-items: center;
            gap: 8px;
            pointer-events: none;
        }

        .grabbing { cursor: grabbing !important; }
        .hand-tool { cursor: grab !important; }

    </style>
</head>
<body>
    <div class="figma-app">
        <!-- TOP TOOLBAR -->
        <div class="figma-toolbar">
            <div class="toolbar-group">
                <div style="width:14px; height:21px; display:flex; flex-wrap:wrap; gap:0; cursor:pointer;" class="toolbar-icon">
                    <div style="width:7px;height:7px; background:#F24E1E; border-radius: 3.5px 0 0 3.5px"></div>
                    <div style="width:7px;height:7px; background:#FF7262; border-radius: 0 3.5px 3.5px 0"></div>
                    <div style="width:7px;height:7px; background:#A259FF; border-radius: 3.5px 0 0 3.5px"></div>
                    <div style="width:7px;height:7px; background:#1ABCFE; border-radius: 50%"></div>
                    <div style="width:7px;height:7px; background:#0ACF83; border-radius: 3.5px 0 3.5px 3.5px"></div>
                </div>
                <!-- Icons -->
                <div class="toolbar-icon active" id="tool-cursor" title="Move Tool (V)"><svg width="14" height="14" viewBox="0 0 12 12" fill="none"><path d="M2.5 11l8-4.5-5.5-.5L3 1.5v9z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/></svg></div>
                <div class="toolbar-icon" id="tool-hand" title="Hand Tool (H / Space)"><svg width="14" height="14" viewBox="0 0 12 12" fill="none"><path d="M3 5.5V3.5a1.5 1.5 0 1 1 3 0v2m0 0V4.5a1.5 1.5 0 1 1 3 0v1m-6 0v1a1.5 1.5 0 1 0 3 0v-1m3 0v1a1.5 1.5 0 1 0 3 0v-2" stroke="currentColor" stroke-width="1.2"/></svg></div>
                <div class="toolbar-icon desktop-only"><svg width="14" height="14" viewBox="0 0 12 12" fill="none"><rect x="1.5" y="1.5" width="9" height="9" stroke="currentColor" stroke-width="1.5" rx="1"/></svg></div>
            </div>

            <div class="toolbar-title">
                <a href="index.html" style="display: flex; align-items: center; gap: 6px; color: rgba(0,0,0,0.5); text-decoration: none; transition: color 0.2s;" onmouseover="this.style.color='#FF7518'" onmouseout="this.style.color='rgba(0,0,0,0.5)'">
                    <span class="desktop-only">Home</span>
                </a>
                <span>/</span>
                <div class="filename">
                    Tech_Stack_Architecture.fig
                </div>
            </div>

            <div class="toolbar-group desktop-only">
                <div class="toolbar-avatar">HR</div>
                <div class="toolbar-icon" style="width: auto; padding: 0 12px; background: rgba(255,255,255,0.08); color: #fff; border-radius: 6px; font-weight: 500; font-size: 11px;">Share</div>
                <div class="toolbar-icon"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg></div>
                <div class="toolbar-icon" style="font-size: 11px; font-weight: 500;" id="zoom-level">100%</div>
            </div>
        </div>

        <div class="figma-workspace">
            <!-- LEFT SIDEBAR -->
            <div class="figma-sidebar figma-sidebar-left">
                <div class="sidebar-tabs">
                    <div class="sidebar-tab active">Layers</div>
                    <div class="sidebar-tab">Assets</div>
                </div>
                <div class="sidebar-content">
                    <div class="layer-item" id="nav-layer-1">
                        <div class="layer-icon">#</div>
                        <div class="layer-name">Stack_Grid</div>
                    </div>
                </div>
            </div>

            <!-- CANVAS -->
            <div class="figma-canvas" id="viewport">
                <!-- ORIGINAL CONTENT -->
                <div class="dark-canvas"></div>
                <div class="grid-overlay"></div>

                <div class="hud-progress">
                    üñ±Ô∏è Tip: <span class="hud-count">Hold Space to Pan ‚Ä¢ Scroll to Zoom</span>
                </div>

                <!-- Panning Canvas -->
                <div class="pan-canvas" id="panCanvas">
                    <!-- Main Frame -->
                    <div class="figma-layer layer-1" style="top: -160px; left: -210px; width: 420px; text-align: left; padding: 0;">
                        <div class="layer-title" style="color: #333;"># Tech_Stack_Grid <span>(Tech_Stack_Architecture.fig)</span></div>
                        
                        <div class="reveal-content" style="padding: 16px 20px; text-align: left; font-family: 'Inter', sans-serif;">
                            
                            <!-- ROW 1: Figma -->
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.05);">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #ffffff; box-shadow: 0 4px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                        <img src="./images/tech-1.svg" alt="Figma" style="width: 16px; height: auto;">
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 2px;">
                                        <div style="font-size: 14px; font-weight: 500; color: #333; letter-spacing: -0.01em;">Figma</div>
                                        <div style="font-size: 11px; color: rgba(0,0,0,0.5);">Leading design tool</div>
                                    </div>
                                </div>
                                <div style="width: 120px; height: 28px; border-radius: 999px; background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); padding: 4px; display: flex; align-items: center;">
                                    <div style="height: 100%; width: 80%; background: #fff; border-radius: 999px; box-shadow: 0 2px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: flex-end; padding-right: 4px;">
                                        <div style="background: #6D6D6D; color: #fff; font-size: 10px; font-weight: 500; padding: 4px 10px; border-radius: 99px; letter-spacing: 0.02em;">80 %</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ROW 2: React -->
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.05);">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #ffffff; box-shadow: 0 4px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: center; flex-shrink: 0; color: #61DAFB;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="2"/><ellipse cx="12" cy="12" rx="10" ry="4"/><ellipse cx="12" cy="12" rx="10" ry="4" transform="rotate(60 12 12)"/><ellipse cx="12" cy="12" rx="10" ry="4" transform="rotate(120 12 12)"/></svg>
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 2px;">
                                        <div style="font-size: 14px; font-weight: 500; color: #333; letter-spacing: -0.01em;">React</div>
                                        <div style="font-size: 11px; color: rgba(0,0,0,0.5);">Frontend library for UI</div>
                                    </div>
                                </div>
                                <div style="width: 120px; height: 28px; border-radius: 999px; background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); padding: 4px; display: flex; align-items: center;">
                                    <div style="height: 100%; width: 90%; background: #fff; border-radius: 999px; box-shadow: 0 2px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: flex-end; padding-right: 4px;">
                                        <div style="background: #6D6D6D; color: #fff; font-size: 10px; font-weight: 500; padding: 4px 10px; border-radius: 99px; letter-spacing: 0.02em;">90 %</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ROW 3: Angular -->
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.05);">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #ffffff; box-shadow: 0 4px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: center; flex-shrink: 0; color: #DD0031;">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L3.19 5.16l1.34 11.66L12 22l7.47-5.18 1.34-11.66L12 2zM12 4.07l6.23 2.22-1.12 9.7L12 19.55l-5.11-3.56-1.12-9.7L12 4.07zM12 7l-2.5 5.5h5L12 7z"/></svg>
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 2px;">
                                        <div style="font-size: 14px; font-weight: 500; color: #333; letter-spacing: -0.01em;">Angular</div>
                                        <div style="font-size: 11px; color: rgba(0,0,0,0.5);">Enterprise framework</div>
                                    </div>
                                </div>
                                <div style="width: 120px; height: 28px; border-radius: 999px; background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); padding: 4px; display: flex; align-items: center;">
                                    <div style="height: 100%; width: 75%; background: #fff; border-radius: 999px; box-shadow: 0 2px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: flex-end; padding-right: 4px;">
                                        <div style="background: #6D6D6D; color: #fff; font-size: 10px; font-weight: 500; padding: 4px 10px; border-radius: 99px; letter-spacing: 0.02em;">75 %</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ROW 4: CSS -->
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(0,0,0,0.05);">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #ffffff; box-shadow: 0 4px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                        <img src="./images/tech-2.svg" alt="CSS" style="width: 16px; height: auto;">
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 2px;">
                                        <div style="font-size: 14px; font-weight: 500; color: #333; letter-spacing: -0.01em;">CSS</div>
                                        <div style="font-size: 11px; color: rgba(0,0,0,0.5);">Styling expertise</div>
                                    </div>
                                </div>
                                <div style="width: 120px; height: 28px; border-radius: 999px; background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); padding: 4px; display: flex; align-items: center;">
                                    <div style="height: 100%; width: 90%; background: #fff; border-radius: 999px; box-shadow: 0 2px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: flex-end; padding-right: 4px;">
                                        <div style="background: #6D6D6D; color: #fff; font-size: 10px; font-weight: 500; padding: 4px 10px; border-radius: 99px; letter-spacing: 0.02em;">90 %</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ROW 5: Javascript -->
                            <div style="display: flex; align-items: center; justify-content: space-between; padding: 12px 0;">
                                <div style="display: flex; align-items: center; gap: 12px;">
                                    <div style="width: 40px; height: 40px; border-radius: 50%; background: #ffffff; box-shadow: 0 4px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                        <img src="./images/tech-3.svg" alt="Javascript" style="width: 18px; height: auto;">
                                    </div>
                                    <div style="display: flex; flex-direction: column; gap: 2px;">
                                        <div style="font-size: 14px; font-weight: 500; color: #333; letter-spacing: -0.01em;">Javascript</div>
                                        <div style="font-size: 11px; color: rgba(0,0,0,0.5);">Core scripting</div>
                                    </div>
                                </div>
                                <div style="width: 120px; height: 28px; border-radius: 999px; background: rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); padding: 4px; display: flex; align-items: center;">
                                    <div style="height: 100%; width: 85%; background: #fff; border-radius: 999px; box-shadow: 0 2px 10px rgba(0,0,0,0.04); border: 1px solid rgba(0,0,0,0.02); display: flex; align-items: center; justify-content: flex-end; padding-right: 4px;">
                                        <div style="background: #6D6D6D; color: #fff; font-size: 10px; font-weight: 500; padding: 4px 10px; border-radius: 99px; letter-spacing: 0.02em;">85 %</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- RIGHT SIDEBAR -->
            <div class="figma-sidebar figma-sidebar-right">
                <div class="sidebar-tabs">
                    <div class="sidebar-tab active">Design</div>
                    <div class="sidebar-tab">Prototype</div>
                </div>
                <div class="sidebar-content">
                    <div class="prop-section">
                        <div class="prop-row">
                            <div class="prop-label">X</div>
                            <div class="prop-value">0</div>
                            <div class="prop-label">Y</div>
                            <div class="prop-value">0</div>
                        </div>
                        <div class="prop-row">
                            <div class="prop-label">W</div>
                            <div class="prop-value">420</div>
                            <div class="prop-label">H</div>
                            <div class="prop-value">AUTO</div>
                        </div>
                    </div>
                    <div class="prop-section">
                        <div class="prop-header">Export</div>
                        <div class="prop-row">
                            <div class="prop-label" style="width: auto; padding-right: 12px;">File</div>
                            <select class="prop-value" style="font-size: 11px; cursor: pointer; border: none; background: rgba(0,0,0,0.05); width: 100%;">
                                <option>PNG (Original)</option>
                                <option>JPG (Preview)</option>
                                <option>SVG (Vector)</option>
                                <option>SVG (Animated)</option>
                            </select>
                        </div>
                        <div style="margin-top: 12px;">
                            <button class="toolbar-icon" style="width: 100%; height: 32px; background: #FF7518; color: #fff; font-weight: 600; font-size: 11px; border: none; border-radius: 4px; cursor: pointer;" onclick="alert('Exporting project preview...')">
                                Export Stack
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Confetti -->
    <div class="confetti-layer" id="confLayer"></div>

    <script>
        const viewport = document.getElementById('viewport');
        const panCanvas = document.getElementById('panCanvas');
        const gridOverlay = document.querySelector('.grid-overlay');
        const zoomLevelDisplay = document.getElementById('zoom-level');
        const toolCursor = document.getElementById('tool-cursor');
        const toolHand = document.getElementById('tool-hand');

        let isDragging = false;
        let startX, startY;
        let translateX = 0;
        let translateY = 0;
        let scale = 1; 
        
        let isSpacePressed = false;
        let isCtrlPressed = false;

        function updateTransform() {
            panCanvas.style.transform = `translate3d(${translateX}px, ${translateY}px, 0) scale(${scale})`;
            gridOverlay.style.backgroundPosition = `${translateX}px ${translateY}px`;
            gridOverlay.style.backgroundSize = `${24 * scale}px ${24 * scale}px`;
            zoomLevelDisplay.innerText = `${Math.round(scale * 100)}%`;
        }

        function updateTools() {
            if (isSpacePressed || isCtrlPressed || isDragging) {
                viewport.classList.add('hand-tool');
                if (isSpacePressed) {
                    toolHand.classList.add('active');
                    toolCursor.classList.remove('active');
                }
            } else {
                viewport.classList.remove('hand-tool');
                toolHand.classList.remove('active');
                toolCursor.classList.add('active');
            }
        }

        viewport.addEventListener('mousedown', (e) => {
            if (isSpacePressed || e.button === 1 || e.target === viewport || e.target === gridOverlay || e.target.classList.contains('dark-canvas')) {
                isDragging = true;
                startX = e.clientX - translateX;
                startY = e.clientY - translateY;
                viewport.classList.add('grabbing');
                updateTools();
                e.preventDefault();
            }
        });

        window.addEventListener('mousemove', (e) => {
            if (!isDragging) return;
            translateX = e.clientX - startX;
            translateY = e.clientY - startY;
            updateTransform();
        });

        window.addEventListener('mouseup', () => {
            isDragging = false;
            viewport.classList.remove('grabbing');
            updateTools();
        });

        window.addEventListener('wheel', (e) => {
            if (e.ctrlKey || e.metaKey) {
                e.preventDefault();
                const zoomSpeed = 0.001;
                const delta = -e.deltaY;
                const newScale = Math.min(Math.max(0.1, scale + delta * zoomSpeed * scale), 5);
                
                const rect = viewport.getBoundingClientRect();
                const mouseX = e.clientX - rect.left - rect.width/2;
                const mouseY = e.clientY - rect.top - rect.height/2;
                
                translateX -= (mouseX - translateX) * (newScale / scale - 1);
                translateY -= (mouseY - translateY) * (newScale / scale - 1);
                
                scale = newScale;
                updateTransform();
            } else {
                e.preventDefault();
                translateY -= e.deltaY;
                translateX -= e.deltaX;
                updateTransform();
            }
        }, { passive: false });

        window.addEventListener('keydown', (e) => {
            if (e.ctrlKey || e.metaKey) {
                isCtrlPressed = true;
                updateTools();
            }
            if (e.code === 'Space') {
                if (!isSpacePressed) {
                    isSpacePressed = true;
                    updateTools();
                }
            }
            if (e.key.toLowerCase() === 'h') {
                isSpacePressed = true;
                updateTools();
            }
            if (e.key.toLowerCase() === 'v') {
                isSpacePressed = false;
                updateTools();
            }
            if (e.ctrlKey && e.code === 'Digit0') {
                e.preventDefault();
                scale = 1;
                translateX = 0;
                translateY = 0;
                updateTransform();
            }
        });

        window.addEventListener('keyup', (e) => {
            if (!e.ctrlKey && !e.metaKey) {
                isCtrlPressed = false;
            }
            if (e.code === 'Space') {
                isSpacePressed = false;
            }
            updateTools();
        });

        window.onload = () => {
            // Initial center align horizontally, but align top vertically
            const rect = viewport.getBoundingClientRect();
            // -160 is the top offset of the frame in the pan-canvas
            translateY = 60 + (160 * scale); 
            translateX = 0;
            
            updateTransform();
            updateTools();
        };

        viewport.addEventListener('mousedown', (e) => {
            if (e.button === 1) e.preventDefault();
        });
    </script>
</body>
</html>
